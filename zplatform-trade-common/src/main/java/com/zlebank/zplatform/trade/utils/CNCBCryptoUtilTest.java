package com.zlebank.zplatform.trade.utils;
import java.security.cert.X509Certificate;


public class CNCBCryptoUtilTest {
	
	private CNCBCryptoUtil util	= null;
	public CNCBCryptoUtilTest()throws Exception{
		util = new CNCBCryptoUtil();

    	//设置签名证书、私钥和私钥密码，实际开发时建议从数据库中读取。
//		String signercrt =
//    		"MIIDMDCCAhigAwIBAgIQEAAAAAAAAAAAAAAwAJgXAzANBgkqhkiG9w0BAQUFADArMQswCQYDVQQGEwJDTjEcMBoGA1UECgwTQ0ZDQSBSU0EgVEVTVCBPQ0EyMTAeFw0xNDA4MjIwNTQ2NTVaFw0xNTA4MjIwNTQ2NTVaMHExCzAJBgNVBAYTAkNOMRUwEwYDVQQKDAxDRkNBIFRFU1QgQ0ExDTALBgNVBAsMBHRjY2IxFDASBgNVBAsMC0VudGVycHJpc2VzMSYwJAYDVQQDDB0wNDFANTE2MzA0MTM2LThAam5jY0AwMDAwMDAwMTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAiicsTm2fklOoNL5a8AJZwYv4ssEzOehUNVpTYX4O+hoF77zEyJdrThkoUiO5sEuE0zXftbR/TZW+yUB2zRo6usam2Um37FcenPyOuEnMDLW87agErGjohBdNnLL2leAZ73YfgRkFWsOnnyC7Oe0dTEh6KevM12lVQqoakF/4KxcCAwEAAaOBjTCBijAfBgNVHSMEGDAWgBTP35n7hiIWEzksB16OPXcruWnvjjALBgNVHQ8EBAMCBPAwHQYDVR0OBBYEFE74ZLR6tsV5JsiNY9YudRaDjf3tMDsGA1UdJQQ0MDIGCCsGAQUFBwMCBggrBgEFBQcDAwYIKwYBBQUHAwQGCCsGAQUFBwMBBggrBgEFBQcDCDANBgkqhkiG9w0BAQUFAAOCAQEAtEH7iJrDUMVX44EA37kATiYgq7ChuKgaLp58Q45GBdXpCUi3RKsjA+PGzdMKAPJ61H00fERb9ieKn/PCSFF25Gr/baxfMeruIN1TjvQBkQFUhYWyDvcMcULEv7HLsXhISuU868wcL3DfAafDuYkcYevrkT6ntL6+6rKAMcecFnd9sXGqkkcBjPH/2VjTZYXKN0ytfFpc81IjA+9VYE4+/szu5D2mbxuMlLRiIsEiuqdMz4nnm+0OCVnyHst3U8C9Ii51vlPRqr/oNips/zArz80p0H0X+kLvLFZZmnQaTd07Fm3s+Nz+E1Cfun37abh4QeyaPQusNeuXDdd21yaomw==";
//    	String signerkey =
//    		"A1JTQdT7XYE8UxM3ASaHxwTH8fKwy9CRhZvI/ZmpVnhmo1m/lb5TCWefnmbgza0DD6IRERjyMX+lkN08PTrRoFWNDgG7jk9yPnk/UUZKwoDb9P8bEO+PfIJxtqhYwvhYfoE1OZvxOBUnxnul/PGBeWJzPGI1mumVU+xd915IFiT2uT8lGqcjr6lXwWwCLZsBbj3O0ZGSWreucBNbyVXb/9M9n4yTqaPf6u94YGoQpXaYTJPW2XcXCJeuUbQbuy11aEtmQ175GLeoWbhgZZjQeafy2Vyd1VCz9hBllWAAbzXZydXv5tV8+IPXQZeFscsk5srREqzDs4q3LFkBB44YIEhA6pttERRSNuyNYR4TgiNwR0vjm24HvVqt8t0/t9tPBdt72SscvepCTdtfH1tRwEhaxc1xSexvn4LTiJ02+3epOGZcDodUWCO/wbelMshaJxjTy6rCd6AerpLznwxf7E4H5VDkq8L5obkoWrppzs+nNm93mvPljJACMELVw4q62hgFKyZQsl2OmAkeEJPrZbjd4cI3tJVXfLGFMJq0Y4SavWSVbD+S1ikeBfu28NbM4vndTJQo/rzQbrja2YpEiPCLLi1RV0YS+lCgFn0c48QWYpwTy9mVY+wQCpBHKF1FfsQmAB8WuzBUXrBSBQJHtflRcG8az1QtZ7AfSB/AY6Wdl/T/P704/2Y4gz8A0lBTw34oGKMQg0Arx6hfx9wFmE6LdSZiWHUK2+IYI/+6oyWI1QUiUz7rjWDR9uTRgj5nMCy7OBuctpszq++uTpOkxvJWevwsQG4qMgJgf6Af9r1vJMaYT1CJPkPsv1Epb+5mEj0mgV3DChWRJMRhzvjWAEnifEyGhEl/y4H3JA==";
//    	String keypasswd = "uMkhUT8";
//    	util.getMethodOfSetSignerCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signercrt.getBytes()});
//    	util.getMethodOfSetSignerPrivatekey().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signerkey.getBytes(), keypasswd});
//    	
//    	//声明信任证书，即为中信银行的B2C网上支付平台服务器证书，用于验证签名是否中信银行签出。
//    	//String trustedCrt = "MIIDqjCCAxOgAwIBAgIQfB+AjIz4vwTeb6ZZ07cUPDANBgkqhkiG9w0BAQUFADAkMQswCQYDVQQGEwJDTjEVMBMGA1UEChMMQ0ZDQSBURVNUIENBMB4XDTA5MDQxNTA4NDgxMFoXDTEwMDQxNTA4NDgxMFowezELMAkGA1UEBhMCQ04xFTATBgNVBAoTDENGQ0EgVEVTVCBDQTENMAsGA1UECxMEdGNjYjESMBAGA1UECxMJQ3VzdG9tZXJzMTIwMAYDVQQDFCkwNDFAMDM1MDU4MjE5NzkwNTMxMjAxM0BlY3Rlc3RlckAwMDAwMDAwOTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAjGLa6wKA2yzQ+jaDFZqUi/nMKQPMFHDRxsJTu87g1fLykjlALah7mklcattEWKNG307nYukxsuOkk/YTRyYX8UvDeZW+wjt3/Zi37KaUZ0CQa1bizEBSz/rsoAw3rMNkrWhjkFsWUTs7IczL9P0h30Gaiik5gxtTytMcWrkIWFcCAwEAAaOCAYQwggGAMB8GA1UdIwQYMBaAFEZy3CVynwJOVYO1gPkL2+mTs/RFMB0GA1UdDgQWBBS4FIZ/HKgymVdnH0iOUky1M8rhVzALBgNVHQ8EBAMCBaAwDAYDVR0TBAUwAwEBADA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEFBQcDBAYIKwYBBQUHAwgwgeUGA1UdHwSB3TCB2jBOoEygSqRIMEYxCzAJBgNVBAYTAkNOMRUwEwYDVQQKEwxDRkNBIFRFU1QgQ0ExDDAKBgNVBAsTA0NSTDESMBAGA1UEAxMJY3JsMTI2XzkwMIGHoIGEoIGBhn9sZGFwOi8vMjEwLjc0LjQxLjg3OjM4OS9DTj1jcmwxMjZfOTAsT1U9Q1JMLE89Q0ZDQSBURVNUIENBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MA0GCSqGSIb3DQEBBQUAA4GBAMTKpwMVvYZUMHkQAXHMVfOE0TxMkSdAF6huAl5c58I8FEhiW1kQXMfRbSNKLKijabu/uMmZZHohQgijCRfmupTF0KYjyT08lZQ1xD+pjOKLHTFdkQvcoJVAua+o1IN1eTgCC4c6LsGJE/cC5MPvI9bCizj9erAt7DbG2kPOeqzh";
//    	String trustedCrt = 
//    		"MIIDYzCCAkugAwIBAgIBMDANBgkqhkiG9w0BAQUFADBMMSwwKgYDVQQKDCNDSElOQSBDSVRJQyBCQU5LIENPUlBPUkFUSU9OIExJTUlURTEcMBoGA1UEAwwTQ05DQiBFQyBURVNUIFNFUlZFUjAeFw0wOTA1MjAxMTA3NDhaFw0yOTA1MTUxMTA3NDhaMEwxLDAqBgNVBAoMI0NISU5BIENJVElDIEJBTksgQ09SUE9SQVRJT04gTElNSVRFMRwwGgYDVQQDDBNDTkNCIEVDIFRFU1QgU0VSVkVSMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx66DA5hrSuSmYj/s6dbiexVSGqswPJbo7JdDDRuyFvZYmejdJBRt0wq1TfTgxVn++sEKByOOYGgZebpOM3/mRfz9QoRm8YqMP5HXHQSNyLnUJ4JfxT5XkFRIC7Gk3eKZmv+fVxRSc09zgsGrS45MgJlQdOo3Ckv1NgV4lBDqHK0EkKthVasQ6tAD5sVQLGHodanwnYa+/4VswHnfpj7z0n6rV1zP4ZAJATNyVOSNRZK2/q7Mf61ypAXKSLTDA/ijnZor7uFMKQsU/V+elK3TeZHG+KZ3pYiG8d0ZDNVjb66Zc4JWuM613uZntt1grI1BRMjIOc2H2Lmp9lx8bJLbeQIDAQABo1AwTjAdBgNVHQ4EFgQUT0mNmQzHwVOFbRJ7dIySrHx0HJUwHwYDVR0jBBgwFoAUT0mNmQzHwVOFbRJ7dIySrHx0HJUwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOCAQEAb+bHgKuswiOdfGpGrw/UttBrwccfBzHo9N/5UYvdoAuchAA893GhQeTXjE1xycfqv3fvRulnnvB8EjwCYfFknxNL9bRwDqK0SpqtyC36h9o0Z8BgItfeehmnYzgtuUnkutyscX2bPj8SmILA5t88cUJYpAPZKvM7QlX6ClM3OCyVxnmYEJmNbXiG7Q+SxtWakPC9pK2OFzeRJGitDBypE/NusbCOqIcaSbqoLl/EuGkpDZPtNlIAtzn8j3cauCeEu4wxDZmGU7oHFPYpeXTzAuqU4sQNHUKJR2ooORdUIROASQitybY5JxaIM0GHQJCJVWH2U280pRr28nlOK02Wgw==";
//    	util.getMethodOfAddTrustedCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{trustedCrt.getBytes()});
//    	//util.getMethodOfAddTrustedCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signercrt.getBytes()});
		
		
    	//设置签名证书、私钥和私钥密码，实际开发时建议从数据库中读取。
    	String signercrt = "MIIDNDCCAhygAwIBAgIQEAAAAAAAAAAAAAAwAJlRODANBgkqhkiG9w0BAQUFADArMQswCQYDVQQGEwJDTjEcMBoGA1UECgwTQ0ZDQSBSU0EgVEVTVCBPQ0EyMTAeFw0xNDA5MTgwMTQ5NDFaFw0xNTA5MTgwMTQ5NDFaMHUxCzAJBgNVBAYTAkNOMRUwEwYDVQQKDAxDRkNBIFRFU1QgQ0ExDTALBgNVBAsMBHRjY2IxFDASBgNVBAsMC0VudGVycHJpc2VzMSowKAYDVQQDDCEwNDFANTkwMDAyMjMyLThAbGlhbnRpYW9AMDAwMDAwMjAwgZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBAIwuQ4YEs6jmF5nrxf2kfAgF721R/QaB1qWhf4kwCLQixGb93G84wswkFIrQ22FIpY5i1H5o5qvxWvtqk7Lktwqgg3F4qb5ZRbqX8shzQrsfVIXOvAef6dqI92pSrfw8cIol+P42iLJ831kW6d+TcMS0f5PpJ0N7l/vJrPUqC5zXAgMBAAGjgY0wgYowHwYDVR0jBBgwFoAUz9+Z+4YiFhM5LAdejj13K7lp744wCwYDVR0PBAQDAgTwMB0GA1UdDgQWBBS1CZRMLk4dxnRpbmky2qE8NgvxWDA7BgNVHSUENDAyBggrBgEFBQcDAgYIKwYBBQUHAwMGCCsGAQUFBwMEBggrBgEFBQcDAQYIKwYBBQUHAwgwDQYJKoZIhvcNAQEFBQADggEBAAyEvLG3eWfDVM0E+4SpC9tzFSgIP0FjIBkRCBr208v9jFfUylU9gQQQWipdbzBkYHFEiXJAdE51sgLVJiqh0d2ahDzeR97+ZY7eykndaO0JgNw4JIkafXsCozHswLjhrfcAL+GFblrkXmBxZhP31kJIXtPTNBZwrlSD43qUrUzQnPSAJVczUe+ONo9PfDQ5uyWSXvyW+vstoLxKlGtNyoxPazR2bSrgbyBz8AXH0IldF0VwOK7Uwlk4JbYEVKpOhQ3h49cKe5+LgFqZtUZKlZBeRZKerTdasMes79lcLU4imBlUVm1eoKP5Mw9Y0nX5UymzjLUBLTxXGUiYFIrCvzI=";
    	String signerkey = "A1JTQYVC4IrMqQQjpp5TfI+gWJtyKtGDkwp+XX7RpUUlkF8quYb+S6f/4m42YzC0SOkrSRXqC35+K66xQ8aSyELH5Lac19slj57lAcQg4crWnJV1EmY3lXwsEXZjMu01OAvHmt9l/yvJmzRdkiesMIC3UV7l0ZGmeckqxyZ6WEKMSKavPVngWM4ftN+k/+YNQ1WMQDSxlA0cflsJhoUNX2/qKqo4bmqxAqt1Ef/X07WAPNra1bIVuIYiVa6edJbYeXd4t7i3ZzW7+dPKKW37NBrLSVZIgn775/hZtOqLh+YU+hUv1BxQUwwvrACVkG86aQWP033fcSl5LlnhY8Xzwg7qB7NSgUkr80n8nwhVloawPVGQc2lY3TZHlfytp+JaQ5gzsM1/J3drToWmLdrqsC6olqOBy/JyOmUHP1QE5/fj9VUgrg+Ok3+3074oPiXMvx1+hGAoEpWcBUCmJuIcdrYBxFScykKyMqTsd7N54BvROj0b3vOserEXwKFihrn8yb/dRj28e6iq0KIOBlpPnxy0FDaOVhzPhvFQBScoAWEfEyraImjd+5lT5F/PBQViJOuaeHnp8654sgLW6Q6gOlCDyktxF8oRxl7m9HJ/H0TKHIefHjwi5STuIMMve65tMxO3HBJIYxudit6bvCGeeEFSwjODinEMcKgs4qg5RV0NgUZhLWuwQU8YWNGQE9NVIfy/zFDjwrGmliZvEPJ02IftmlG8Ia4ezdoCUsSDezShB3ljy13/2bCyl2YUtHnHAmNlB/kLQHrB7+ALypQS9OGZAcOxvhYC2VSV9hZIzidYQQZMNBJg7faMb9hRW1r/qNNn95q6FQ+HZNoMQRQTo5V1PKRd7Zb7kVujUg==";
    	String keypasswd = "gXSEQ9q";
    	util.getMethodOfSetSignerCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signercrt.getBytes()});
    	util.getMethodOfSetSignerPrivatekey().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signerkey.getBytes(), keypasswd});
    	//String trustedCrt = 
    		//"MIIDYzCCAkugAwIBAgIBMDANBgkqhkiG9w0BAQUFADBMMSwwKgYDVQQKDCNDSElOQSBDSVRJQyBCQU5LIENPUlBPUkFUSU9OIExJTUlURTEcMBoGA1UEAwwTQ05DQiBFQyBURVNUIFNFUlZFUjAeFw0wOTA1MjAxMTA3NDhaFw0yOTA1MTUxMTA3NDhaMEwxLDAqBgNVBAoMI0NISU5BIENJVElDIEJBTksgQ09SUE9SQVRJT04gTElNSVRFMRwwGgYDVQQDDBNDTkNCIEVDIFRFU1QgU0VSVkVSMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAx66DA5hrSuSmYj/s6dbiexVSGqswPJbo7JdDDRuyFvZYmejdJBRt0wq1TfTgxVn++sEKByOOYGgZebpOM3/mRfz9QoRm8YqMP5HXHQSNyLnUJ4JfxT5XkFRIC7Gk3eKZmv+fVxRSc09zgsGrS45MgJlQdOo3Ckv1NgV4lBDqHK0EkKthVasQ6tAD5sVQLGHodanwnYa+/4VswHnfpj7z0n6rV1zP4ZAJATNyVOSNRZK2/q7Mf61ypAXKSLTDA/ijnZor7uFMKQsU/V+elK3TeZHG+KZ3pYiG8d0ZDNVjb66Zc4JWuM613uZntt1grI1BRMjIOc2H2Lmp9lx8bJLbeQIDAQABo1AwTjAdBgNVHQ4EFgQUT0mNmQzHwVOFbRJ7dIySrHx0HJUwHwYDVR0jBBgwFoAUT0mNmQzHwVOFbRJ7dIySrHx0HJUwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOCAQEAb+bHgKuswiOdfGpGrw/UttBrwccfBzHo9N/5UYvdoAuchAA893GhQeTXjE1xycfqv3fvRulnnvB8EjwCYfFknxNL9bRwDqK0SpqtyC36h9o0Z8BgItfeehmnYzgtuUnkutyscX2bPj8SmILA5t88cUJYpAPZKvM7QlX6ClM3OCyVxnmYEJmNbXiG7Q+SxtWakPC9pK2OFzeRJGitDBypE/NusbCOqIcaSbqoLl/EuGkpDZPtNlIAtzn8j3cauCeEu4wxDZmGU7oHFPYpeXTzAuqU4sQNHUKJR2ooORdUIROASQitybY5JxaIM0GHQJCJVWH2U280pRr28nlOK02Wgw==";
    	String trustedCrt = "MIIDQTCCAimgAwIBAgIBMDANBgkqhkiG9w0BAQUFADA7MQswCQYDVQQGEwJDTjENMAsGA1UECwwEQ05DQjEdMBsGA1UEAwwUY2JlYy5iYW5rLmVjaXRpYy5jb20wHhcNMTMxMjE5MDczMjUxWhcNNDMxMjEyMDczMjUxWjA7MQswCQYDVQQGEwJDTjENMAsGA1UECwwEQ05DQjEdMBsGA1UEAwwUY2JlYy5iYW5rLmVjaXRpYy5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCPuwtdgVkZgxb7WUKJsnPWhOAScS6XUhLr8btTFJEGPnO+jEJcUHccxIZ2WH40FfqJqU1ZCyDHkeaS1cnhztISkM2RqEnowNs6Mm6UXjGfDgEO85yccLM11inBK1oKu/i5B7sfxOgyswCecVPutuHO6S76AtF1INBpBPIYcneAyKlFlEIVfF8A5NfHtJnuQsnC/Uhryh+uEdOSeAov9HDi+ui3SILz2aYAjMwazbloJZovdzasiHDi/i2BJsjZrkI91pTI0kOlX/XF7zfrfGQCe9F9NS7W1Da0wQ+eSsDE5TtBYEksr5FUttO+qosG9zQCGY+5ziuJn4JhZBmeqox/AgMBAAGjUDBOMB0GA1UdDgQWBBTggpp3peJsP4yXaYM7Q4O6UA/SXDAfBgNVHSMEGDAWgBTggpp3peJsP4yXaYM7Q4O6UA/SXDAMBgNVHRMEBTADAQH/MA0GCSqGSIb3DQEBBQUAA4IBAQA7G5bFqh3LTsM4SxfWJmFOWcc0ZTkGVnH9SgiP/zar/jMfy4bvQA8n4jE7PKhpEF2zrohPQIi9daonmmPjRdILlLgd39xif0yZ1aY5nOXpXphruQQZ7KSIaMgp6Yd67txnJbrSc2Qg10PEtZFFWoux2sF8iF3rRcGZj3pIKQ0dkz9E4VyyHN+WCy6nRQIH1HnIYf2wWuujcIBYwaY39qmY7i82fZzOaEaag4h7MWbKEEjJqqylRo8WU5sYxBQnL6EJ1yJH9/RN/9nQosmmviL133FWMIH33rPjD+r9tIEXRSo53OJabNyyzMFVPOFZ1JgqUbJSrOKtkigiQPQ/SpNu";
    	   
    	//声明信任证书，即为中信银行的B2C网上支付平台服务器证书，用于验证签名是否中信银行签出。
    	//String trustedCrt = "MIIDqjCCAxOgAwIBAgIQfB+AjIz4vwTeb6ZZ07cUPDANBgkqhkiG9w0BAQUFADAkMQswCQYDVQQGEwJDTjEVMBMGA1UEChMMQ0ZDQSBURVNUIENBMB4XDTA5MDQxNTA4NDgxMFoXDTEwMDQxNTA4NDgxMFowezELMAkGA1UEBhMCQ04xFTATBgNVBAoTDENGQ0EgVEVTVCBDQTENMAsGA1UECxMEdGNjYjESMBAGA1UECxMJQ3VzdG9tZXJzMTIwMAYDVQQDFCkwNDFAMDM1MDU4MjE5NzkwNTMxMjAxM0BlY3Rlc3RlckAwMDAwMDAwOTCBnzANBgkqhkiG9w0BAQEFAAOBjQAwgYkCgYEAjGLa6wKA2yzQ+jaDFZqUi/nMKQPMFHDRxsJTu87g1fLykjlALah7mklcattEWKNG307nYukxsuOkk/YTRyYX8UvDeZW+wjt3/Zi37KaUZ0CQa1bizEBSz/rsoAw3rMNkrWhjkFsWUTs7IczL9P0h30Gaiik5gxtTytMcWrkIWFcCAwEAAaOCAYQwggGAMB8GA1UdIwQYMBaAFEZy3CVynwJOVYO1gPkL2+mTs/RFMB0GA1UdDgQWBBS4FIZ/HKgymVdnH0iOUky1M8rhVzALBgNVHQ8EBAMCBaAwDAYDVR0TBAUwAwEBADA7BgNVHSUENDAyBggrBgEFBQcDAQYIKwYBBQUHAwIGCCsGAQUFBwMDBggrBgEFBQcDBAYIKwYBBQUHAwgwgeUGA1UdHwSB3TCB2jBOoEygSqRIMEYxCzAJBgNVBAYTAkNOMRUwEwYDVQQKEwxDRkNBIFRFU1QgQ0ExDDAKBgNVBAsTA0NSTDESMBAGA1UEAxMJY3JsMTI2XzkwMIGHoIGEoIGBhn9sZGFwOi8vMjEwLjc0LjQxLjg3OjM4OS9DTj1jcmwxMjZfOTAsT1U9Q1JMLE89Q0ZDQSBURVNUIENBLEM9Q04/Y2VydGlmaWNhdGVSZXZvY2F0aW9uTGlzdD9iYXNlP29iamVjdGNsYXNzPWNSTERpc3RyaWJ1dGlvblBvaW50MA0GCSqGSIb3DQEBBQUAA4GBAMTKpwMVvYZUMHkQAXHMVfOE0TxMkSdAF6huAl5c58I8FEhiW1kQXMfRbSNKLKijabu/uMmZZHohQgijCRfmupTF0KYjyT08lZQ1xD+pjOKLHTFdkQvcoJVAua+o1IN1eTgCC4c6LsGJE/cC5MPvI9bCizj9erAt7DbG2kPOeqzh";
    	//String trustedCrt = "MIICezCCAeSgAwIBAgIEPPyMXjANBgkqhkiG9w0BAQUFADAgMQswCQYDVQQGEwJDTjERMA8GA1UEChMIQ0ZDQSBSQ0EwHhcNMDQwODEwMDgzNjM3WhcNMTQwNzI1MTYwMDAwWjAkMQswCQYDVQQGEwJDTjEVMBMGA1UEChMMQ0ZDQSBURVNUIENBMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDYrs50M7hq8y0LzFjfN3UPQzGiBg1kLinPqJcSx7oRXey15WpLLMLthcfp9Gn/7uXmtNL6athr91YXzrB3Rcp53U3zqScGE9h2ktFQ3SNdZP6c/VSQ+27pAVxWRUC+F6pmUsno+jd1mftYjhKRV8yvCRpSV6HDzhLK83xbkoCfiQIDAQABo4G9MIG6MEIGA1UdHwQ7MDkwN6A1oDOkMTAvMQswCQYDVQQGEwJDTjERMA8GA1UEChMIQ0ZDQSBSQ0ExDTALBgNVBAMTBENSTDEwCwYDVR0PBAQDAgEGMB8GA1UdIwQYMBaAFACaNPJR+VMUYXRucqEG3seBcBu8MB0GA1UdDgQWBBRGctwlcp8CTlWDtYD5C9vpk7P0RTAMBgNVHRMEBTADAQH/MBkGCSqGSIb2fQdBAAQMMAobBFY2LjADAgSQMA0GCSqGSIb3DQEBBQUAA4GBAJ69l0Y1K+ayEvojzBHfzozMf0a0aQMaEbiil+RJQ8lvwWHZOeaRTcJOxyiPoQ5DZqhEusXavFPX4J/mE3H5PCnV5tF7tSO7vEguhs8m2IXxrOZCpKmCJVevNdV9x0m9eD629NVJGf683raMx39Ft4HQFaLT+EXbnSAWvYemPyOW";
    	util.getMethodOfAddTrustedCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{trustedCrt.getBytes()});
    	//util.getMethodOfAddTrustedCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signercrt.getBytes()});
		
    	
    	System.out.println("sign message testing ...");
    	byte[] signedMessage = (byte[])util.getMethodOfSign().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{"<message>order</message>".getBytes()});
    		
    		
    	//对明文消息进行签名，得到BASE64编码的密文消息，包含了明文、签名和证书数据
    	
    	System.out.println("signed messge size:"+signedMessage.length);
    	System.out.println("signed messge:\n"+new String(signedMessage));
    	System.out.println("sign message testing ...ok");
	}
  
   byte[] sign(String message)throws Exception{	
    	//对明文消息进行签名，得到BASE64编码的密文消息，包含了明文、签名和证书数据
    	byte[] signedMessage	= (byte[])util.getMethodOfSign().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{message.getBytes()});
		return signedMessage;
    }
    
   public byte[] verify(String signedMessage)throws Exception{
    	//对密文数据进行验签
    	util.getMethodOfVerify().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signedMessage.getBytes()});   	
    	byte[] message	= (byte[])util.getMethodOfOfGetOrderMessage().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signedMessage.getBytes()});   
    	return message;
    }
   
   X509Certificate getSignerCertificate(String signedMessage)throws Exception{
	   X509Certificate crt = (X509Certificate)util.getMethodOfGetSignerCertificate().invoke(util.getObjectOfECCryptoProcessor(), new Object[]{signedMessage.getBytes()});   
	   return crt;
   }
   
   public static void main(String[] args)throws Exception{
   	/**********签名接口调用*************/
   	//
		CNCBCryptoUtilTest test = new CNCBCryptoUtilTest();
    	System.out.println("sign message testing ...");
    	 String message="<?xml version=\"1.0\" encoding=\"GBK\"?><stream><MERID>302451079940001</MERID><ORDERNO>20140829105832195482</ORDERNO><MERJNLNO>20140829105832195482</MERJNLNO><TRANTYPE>00</TRANTYPE><REQRESERVED>test</REQRESERVED></stream>";
    	byte[] signedMessage = test.sign(message);
    	System.out.println("signed messge size:"+signedMessage.length);
    	System.out.println("signed messge:\n"+new String(signedMessage));
    	System.out.println("sign message testing ...ok");
    	
    	
    	/**********验签接口调用*************/
    	System.out.println("verify signature testing ...");
    	String stringOfSignedMessage =
    		"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";
    	//String stringOfSignedMessage = "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";
    	byte[] source = test.verify(new String(stringOfSignedMessage));
    	System.out.println("verify signed messge ok");
    	System.out.println("source messge:\n"+new String(source));
    	System.out.println("verify signature testing ...ok");
//    	X509Certificate crt = test.getSignerCertificate(stringOfSignedMessage);
//    	System.out.println("signer certificate:\n"+crt.getSubjectDN());	 
   }
}
